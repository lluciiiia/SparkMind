import{B as r}from"./browser-polyfill-BZs9fRMg.js";const i={gauthAccessToken:"gauthAccessToken",gauthRefreshToken:"gauthRefreshToken"},n=async(s,g,e)=>{if(e.status==="complete"&&e.url){const t=new URL(e.url);if(t.origin==="https://my.webapp.com"){const o=new URLSearchParams(t.hash.substring(1)),a=o.get("access_token"),c=o.get("refresh_token");a&&c&&(e.id&&await r.tabs.remove(e.id),await r.storage.sync.set({[i.gauthAccessToken]:a,[i.gauthRefreshToken]:c}),r.tabs.onUpdated.removeListener(n))}}};try{r.runtime.onMessage.addListener((s,g,e)=>{if(s.action==="signInWithGoogle"){r.tabs.onUpdated.removeListener(n);const t=s.payload.url;r.tabs.create({url:t,active:!0},o=>{r.tabs.onUpdated.addListener(n),e({message:"signInWithGoogle executed"})})}return!0})}catch(s){throw console.error("Error in background.js:",s),new Error("Error in background.js:",s)}
